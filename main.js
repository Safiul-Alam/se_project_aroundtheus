!function(){"use strict";class t{constructor(t,e,s,i,r){this.isLiked=t.isLiked,this._name=t.name,this._link=t.link,this._id=t._id,this._cardSelector=e,this._handleImageClick=s,this._handleDeleteClick=i,this._handleLikeClick=r}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_handleLikeButton(){this._likeButton.classList.toggle("card__like_button_active")}_handleDeleteCard(){this._cardElement.remove()}renderLikeIcon(){this.isLiked?this._likeButton.classList.add("card__like_button_active"):this._likeButton.classList.remove("card__like_button_active")}setIsLiked(t){this.isLiked=t,this.renderLikeIcon()}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeClick(this)})),this._cardElement.querySelector(".card__delete_button").addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}remove(){this._cardElement.remove()}getView(){this._cardElement=this._getTemplate(),this._likeButton=this._cardElement.querySelector(".card__like_button");const t=this._cardElement.querySelector(".card__image");return t.src=this._link,t.alt=this._name,this._cardElement.querySelector(".card__title").textContent=this._name,this.renderLikeIcon(),this._setEventListeners(),this._cardElement}}var e=class{constructor(t,e){this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._formElement=e,this._inputList=[...this._formElement.querySelectorAll(this._inputSelector)],this._submitButton=this._formElement.querySelector(this._submitButtonSelector)}_showInputError(t){const e=this._formElement.querySelector(`#${t.id}-error`);t.classList.add(this._inputErrorClass),e.textContent=t.validationMessage,e.classList.add(this._errorClass)}_hideInputError(t){const e=this._formElement.querySelector(`#${t.id}-error`);t.classList.remove(this._inputErrorClass),e.textContent="",e.classList.remove(this._errorClass)}_checkInputValidity(t){t.validity.valid?this._hideInputError(t):this._showInputError(t)}_hasInvalidInput(){return this._inputList.some((t=>!t.validity.valid))}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_toggleButtonState(){this._hasInvalidInput()?this.disableButton():this._enableButton()}_setEventListeners(){this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this._toggleButtonState()}))}))}resetValidation(){this._toggleButtonState(),this._inputList.forEach((t=>{this._hideInputError(t)}))}enableValidation(){this._formElement.addEventListener("submit",(t=>{t.preventDefault()})),this._setEventListeners(),this._toggleButtonState()}};const s=document.forms["card-add-form"],i=document.forms["profile-edit-form"],r=(document.querySelector(".cards__list"),{formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"});class n{constructor(t){let{popupSelector:e}=t;this._popupElement=document.querySelector(e),this._closeButton=this._popupElement.querySelector(".modal__close"),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.toggle("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(t){"Escape"===t.key&&this.close()}setEventListeners(){this._closeButton.addEventListener("click",(()=>{this.close()})),this._popupElement.addEventListener("click",(t=>{t.target===t.currentTarget&&this.close()}))}}class o extends n{constructor(t,e){super({popupSelector:t}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._inputList=[...this._popupForm.querySelectorAll(".modal__input")],this._handleFormSubmit=e,this._submitButton=this._popupElement.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent}_getInputValues(){return this._formValues={},this._inputList.forEach((t=>{this._formValues[t.name]=t.value})),this._formValues}setInputValues(t){this._inputList.forEach((e=>{e.value=t[e.name]}))}resetButtonText(){this._submitButton.textContent=this._submitButtonText}closeAfterSubmit(){this._popupForm.reset(),this.close()}handleLoad(t,e){this._submitButton.textContent=t?e:this._submitButtonText}setEventListeners(){this._popupForm.addEventListener("submit",(t=>{t.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}}const a=new class{constructor(t){let{baseUrl:e,headers:s}=t;this._baseUrl=e,this._headers=s}_request(t,e){let{method:s,body:i}=e;return fetch(`${this._baseUrl}${t}`,{headers:this._headers,method:s,body:i}).then((t=>this._checkResponse(t)))}_checkResponse(t){return t.ok?t.json():Promise.reject(`Error: ${t.status}`)}getInitialCards(){return this._request("/cards",{})}getUserInfo(){return this._request("/users/me",{})}setUserInfo(t){let{modalTitle:e,description:s}=t;return this._request("/users/me",{method:"PATCH",body:JSON.stringify({name:e,about:s})})}setUserAvatar(t){return this._request("/users/me/avatar",{method:"PATCH",body:JSON.stringify({avatar:t})})}uploadCard(t){let{name:e,link:s}=t;return this._request("/cards",{method:"POST",body:JSON.stringify({name:e,link:s})})}deleteCard(t){return this._request(`/cards/${t}`,{method:"DELETE"})}updateCardLike(t,e){return this._request(`/cards/${t}/likes`,{method:e})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"13ca465c-2480-4978-b0a0-252ae6127405","Content-Type":"application/json"}}),l=new class{constructor(t){let{userName:e,userJob:s,avatarSelector:i}=t;this.userName=document.querySelector(e),this.userJob=document.querySelector(s),this.avatar=document.querySelector(i)}getUserInfo(){return this._userInfo={modalTitle:this.userName.textContent,description:this.userJob.textContent},this._userInfo}setUserInfo(t){let{modalTitle:e,description:s}=t;this.userName.textContent=e,this.userJob.textContent=s}setAvatarImage(t){this.avatar.src=t}}({userName:".profile__title",userJob:".profile__description",avatarSelector:".profile__image"});function c(e){return new t(e,"#card-template",m,u,d).getView()}function u(t){L.open(),L.setSubmit((()=>{a.deleteCard(t._id).then((()=>{t.remove(),L.close()})).catch((t=>alert(`Error: ${t}`)))}))}function d(t){const e=t.isLiked?"DELETE":"PUT";a.updateCardLike(t._id,e).then((e=>{t.setIsLiked(e.isLiked)})).catch((t=>alert(`Error: ${t}`)))}a.getUserInfo().then((t=>{l.setUserInfo({modalTitle:t.name,description:t.about}),l.setAvatarImage(t.avatar)})).catch((t=>alert(t)));const h=new class{constructor(t){let{renderer:e,selector:s}=t;this._renderer=e,this._element=document.querySelector(s)}renderItems(t){t.forEach((t=>this._renderer(t)))}addItem(t){this._element.prepend(t)}}({renderer:t=>{const e=c(t);h.addItem(e)},selector:".cards__list"});a.getInitialCards().then((t=>{h.renderItems(t)})).catch((t=>alert(t)));const _=new class extends n{constructor(t){super({popupSelector:t}),this._imageEl=this._popupElement.querySelector(".modal__image"),this._titleEl=this._popupElement.querySelector(".modal__caption")}open(t){this._imageEl.src=t.link,this._imageEl.alt=t.name,this._titleEl.textContent=t.name,super.open()}}("#image-preview-modal");function m(t){_.open(t)}_.setEventListeners();const p=new e(r,s);p.enableValidation();const E=new o("#card-add-modal",(function(t){let{title:e,url:i}=t;E.handleLoad(!0,"Saving...");const r={name:e,link:i};a.uploadCard(r).then((t=>{const e=c(t);h.addItem(e),E.close(),p.disableButton(),s.reset()})).catch((t=>{console.error("Error adding card:",t)})).finally((()=>{E.handleLoad(!1)}))}));E.setEventListeners(),document.querySelector(".profile__add-button").addEventListener("click",(()=>{E.open()}));const v=new e(r,i);v.enableValidation();const b=new o("#profile-edit-modal",(function(t){b.handleLoad(!0,"Saving..."),a.setUserInfo(t).then((()=>{l.setUserInfo(t),b.close(),i.reset()})).catch((t=>{console.error("Error updating profile:",t)})).finally((()=>{b.handleLoad(!1)}))}));b.setEventListeners(),document.querySelector(".profile__edit-button").addEventListener("click",(()=>{const t=l.getUserInfo();b.setInputValues(t),v.resetValidation(),b.open()}));const L=new class extends n{constructor(t,e){super({popupSelector:t}),this._submitButton=this._popupElement.querySelector(".modal__button"),this._onConfirm=e,this._submitButtonText=this._submitButton.textContent}setSubmit(t){this._handleSubmitCallback=t}setEventListeners(){super.setEventListeners(),this._submitButton.addEventListener("click",(t=>{t.preventDefault(),this._handleSubmitCallback()}))}}("#modal-confirm",(()=>{}));L.setEventListeners();const f=document.querySelector("#edit-avatar-form"),S=new e(r,f);S.enableValidation();const k=new o("#edit-avatar-modal",(function(t){k.handleLoad(!0,"Saving..."),a.setUserAvatar(t.avatar).then((()=>{l.setAvatarImage(t.avatar),k.close(),f.reset(),S.disableButton(),f.reset()})).catch((t=>{console.error(t)})).finally((()=>{k.handleLoad(!1)}))}));k.setEventListeners(),document.querySelector(".profile__edit-image").addEventListener("click",(function(){k.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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N0UsS0FBS2dELGNBQWdCaEQsS0FBSzhFLGNBQWNqRSxjQUFjLGtCQUN0RGIsS0FBSzBMLFdBQWFELEVBQ2xCekwsS0FBSytGLGtCQUFvQi9GLEtBQUtnRCxjQUFjaEIsV0FDOUMsQ0FFQTBILFNBQUFBLENBQVVpQyxHQUNSM0wsS0FBSzRMLHNCQUF3QkQsQ0FDL0IsQ0FFQXBHLGlCQUFBQSxHQUNFSyxNQUFNTCxvQkFDTnZGLEtBQUtnRCxjQUFjckIsaUJBQWlCLFNBQVUwRCxJQUM1Q0EsRUFBSWhCLGlCQUNKckUsS0FBSzRMLHVCQUF1QixHQUVoQyxHTGtMNkMsa0JBQWtCLFNBQ2pFbkMsRUFBYWxFLG9CQUdiLE1BQU1zRyxFQUFtQmpMLFNBQVNDLGNBQWMscUJBQzFDaUwsRUFBMEIsSUFBSWhCLEVBQ2xDckcsRUFDQW9ILEdBRUZDLEVBQXdCM0gsbUJBRXhCLE1BQU00SCxFQUF1QixJQUFJckcsRUFDL0Isc0JBS0YsU0FBc0MvRixHQUNwQ29NLEVBQXFCdkYsWUFBVyxFQUFNLGFBQ3RDRyxFQUNHNEIsY0FBYzVJLEVBQUs2SSxRQUNuQmxCLE1BQUssS0FDSndCLEVBQVNLLGVBQWV4SixFQUFLNkksUUFDN0J1RCxFQUFxQjVHLFFBQ3JCMEcsRUFBaUJ0RixRQUVqQnVGLEVBQXdCakksZ0JBQ3hCZ0ksRUFBaUJ0RixPQUFPLElBRXpCb0QsT0FBT0MsSUFDTnlCLFFBQVFELE1BQU14QixFQUFJLElBRW5CMEIsU0FBUSxLQUNQUyxFQUFxQnZGLFlBQVcsRUFBTSxHQUU1QyxJQXBCQXVGLEVBQXFCeEcsb0JBc0JLM0UsU0FBU0MsY0FBYyx3QkFDL0JjLGlCQUFpQixTQUFTLFdBQzFDb0ssRUFBcUI3RyxNQUN2QixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICBkYXRhLFxuICAgIGNhcmRTZWxlY3RvcixcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxuICAgIGhhbmRsZUxpa2VDbGlja1xuICApIHtcbiAgICB0aGlzLmlzTGlrZWQgPSBkYXRhLmlzTGlrZWQ7IC8vdGhpcyBvbmVcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGljaztcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XG4gIH1cblxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgY29uc3QgY2FyZEVsID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgICByZXR1cm4gY2FyZEVsO1xuICB9XG5cbiAgX2hhbmRsZUxpa2VCdXR0b24oKSB7XG4gICAgLy8gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlX2J1dHRvblwiKVxuICAgIC8vICAgLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlX2J1dHRvbl9hY3RpdmVcIik7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZV9idXR0b25fYWN0aXZlXCIpO1xuICB9XG5cbiAgX2hhbmRsZURlbGV0ZUNhcmQoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gIH1cblxuICByZW5kZXJMaWtlSWNvbigpIHtcbiAgICBpZiAodGhpcy5pc0xpa2VkKSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlX2J1dHRvbl9hY3RpdmVcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2VfYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9XG4gIH1cblxuICBzZXRJc0xpa2VkKGlzTGlrZWQpIHtcbiAgICB0aGlzLmlzTGlrZWQgPSBpc0xpa2VkOyAvLyB0aGlzIGFsbG93cyB0byBjaGFuZ2UgdGhlIHZhbHVlIG9mIGlzTGlrZWRcbiAgICB0aGlzLnJlbmRlckxpa2VJY29uKCk7IC8vIHRoaXMgd2lsbCB1cGRhdGUgdGhlIGljb24gdmlzdWFsbHlcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAvLyB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2VfYnV0dG9uXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgLy8gICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKCk7XG4gICAgLy8gfSk7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgLy8gdGhpcy5faGFuZGxlTGlrZUJ1dHRvbigpOyAvLyA/XG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sodGhpcyk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlX2J1dHRvblwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKHRoaXMpO1xuICAgICAgfSk7XG5cbiAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHsgbmFtZTogdGhpcy5fbmFtZSwgbGluazogdGhpcy5fbGluayB9KTtcbiAgICAgIH0pO1xuICB9XG5cbiAgcmVtb3ZlKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuICB9XG5cbiAgZ2V0VmlldygpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZV9idXR0b25cIik7XG4gICAgY29uc3QgY2FyZEltYWdlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgICBjYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcbiAgICBjYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcblxuICAgIGNvbnN0IGNhcmRUaXRsZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XG4gICAgY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcblxuICAgIHRoaXMucmVuZGVyTGlrZUljb24oKTtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xuICB9XG59XG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XG5cbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IFsuLi50aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gJyc7XG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XG4gICAgfVxuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCk7XG4gIH1cblxuICBkaXNhYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gIH1cblxuICBfZW5hYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xuICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfSk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAvLyB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpOyAgLy8gQ2FsbCB0byBjaGVjayB0aGUgYnV0dG9uIHN0YXRlIG9uIHN1Ym1pdFxuICAgIH0pO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yO1xuIiwiXG5cbmV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhdGVtYXIuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxuICB9LFxuXTtcblxuZXhwb3J0IGNvbnN0IGNhcmRBZGRGb3JtID0gZG9jdW1lbnQuZm9ybXNbJ2NhcmQtYWRkLWZvcm0nXTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEZvcm0gPSBkb2N1bWVudC5mb3Jtc1sncHJvZmlsZS1lZGl0LWZvcm0nXTtcbmV4cG9ydCBjb25zdCBjYXJkTGlzdEVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRzX19saXN0Jyk7XG5cblxuXG5leHBvcnQgY29uc3Qgc2VsZWN0b3JzID0ge1xuICBjYXJkVGVtcGxhdGU6ICcjY2FyZC10ZW1wbGF0ZScsXG4gIGNhcmRTZWxlY3Rpb246ICcuY2FyZHNfX2xpc3QnLFxuICAvLyBhbnkgb3RoZXIgc2VsZWN0b3JzIHlvdSBtaWdodCBuZWVkXG59O1xuXG4vLyBGb3JtVmFsaWRhdGlvblxuZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25TZXR0aW5ncyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXG5cbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcbn07IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3J9KSB7XG5cbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Nsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ21vZGFsX29wZW5lZCcpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKCdtb2RhbF9vcGVuZWQnKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XG4gICAgLy8gbGlzdGVucyBmb3IgZXNjIGJ1dHRvblxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgLy8gc2V0cyBldmVudCBsaXN0ZW5lcnNcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoZXZ0LnRhcmdldCA9PT0gZXZ0LmN1cnJlbnRUYXJnZXQpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbLi4udGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpXTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgLy8gdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmZvcm1fX2lucHV0XCIpO1xuICAgIHRoaXMuX2Zvcm1WYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIHRoaXMuX2Zvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5fZm9ybVZhbHVlcztcbiAgfVxuXG4gIHNldElucHV0VmFsdWVzKGRhdGEpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcbiAgICB9KTtcbiAgfVxuXG4gIHJlc2V0QnV0dG9uVGV4dCgpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b25UZXh0O1xuICB9XG5cbiAgY2xvc2VBZnRlclN1Ym1pdCgpIHtcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcbiAgICAvLyB0aGlzLm9wZW4oKTtcbiAgICB0aGlzLmNsb3NlKCk7XG4gIH1cblxuICBoYW5kbGVMb2FkKGlzTG9hZGluZywgbG9hZGluZ1RleHQpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnV0dG9uVGV4dDtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgICAvLyB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcbiAgICB9KTtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG59XG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuXG4vLyBpbXBvcnQgYWxsIHRoZSBjbGFzc2VzXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQge1xuICBpbml0aWFsQ2FyZHMsXG4gIHNlbGVjdG9ycyxcbiAgdmFsaWRhdGlvblNldHRpbmdzLFxuICBjYXJkQWRkRm9ybSxcbiAgcHJvZmlsZUVkaXRGb3JtLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcbmltcG9ydCB7IFBvcHVwV2l0aENvbmZpcm1hdGlvbiB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qc1wiO1xuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCIxM2NhNDY1Yy0yNDgwLTQ5NzgtYjBhMC0yNTJhZTYxMjc0MDVcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG4vL3VzZXJJbmZvXG5jb25zdCBwcm9maWxlTmFtZSA9IFwiLnByb2ZpbGVfX3RpdGxlXCI7XG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiO1xuLy8gQ3JlYXRlIHVzZXIgaW5mbyBpbnN0YW5jZVxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICB1c2VyTmFtZTogcHJvZmlsZU5hbWUsXG4gIHVzZXJKb2I6IHByb2ZpbGVEZXNjcmlwdGlvbixcbiAgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXG59KTtcblxuYXBpXG4gIC5nZXRVc2VySW5mbygpXG4gIC50aGVuKChyZXMpID0+IHtcbiAgICAvLyBjb25zb2xlLmxvZyhyZXMpO1xuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHsgbW9kYWxUaXRsZTogcmVzLm5hbWUsIGRlc2NyaXB0aW9uOiByZXMuYWJvdXQgfSk7XG4gICAgdXNlckluZm8uc2V0QXZhdGFySW1hZ2UocmVzLmF2YXRhcik7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiBhbGVydChlcnIpKTtcblxuXG5cbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoZGF0YSkge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXG4gICAgZGF0YSxcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXG4gICAgb3BlblByZXZpZXdNb2RhbCxcbiAgICBoYW5kbGVDYXJkRGVsZXRlLFxuICAgIGhhbmRsZUNhcmRMaWtlXG4gICk7XG4gIHJldHVybiBjYXJkLmdldFZpZXcoKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQ2FyZERlbGV0ZShjYXJkKSB7XG4gIGNvbmZpcm1Qb3B1cC5vcGVuKCk7XG4gIGNvbmZpcm1Qb3B1cC5zZXRTdWJtaXQoKCkgPT4ge1xuICAgIGFwaVxuICAgICAgLmRlbGV0ZUNhcmQoY2FyZC5faWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNhcmQucmVtb3ZlKCk7XG4gICAgICAgIGNvbmZpcm1Qb3B1cC5jbG9zZSgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBhbGVydChgRXJyb3I6ICR7ZXJyfWApKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUNhcmRMaWtlKGNhcmQpIHtcbiAgY29uc3QgbWV0aG9kID0gY2FyZC5pc0xpa2VkID8gXCJERUxFVEVcIiA6IFwiUFVUXCI7XG5cbiAgYXBpXG4gICAgLnVwZGF0ZUNhcmRMaWtlKGNhcmQuX2lkLCBtZXRob2QpXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgLy8gY29uc29sZS5sb2cocmVzKTtcbiAgICAgIGNhcmQuc2V0SXNMaWtlZChyZXMuaXNMaWtlZCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4gYWxlcnQoYEVycm9yOiAke2Vycn1gKSk7XG59XG5cblxuXG5jb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKHtcbiAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XG4gICAgY29uc3QgY2FyZEVsID0gY3JlYXRlQ2FyZChpdGVtKTtcbiAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRFbCk7XG4gIH0sXG4gIHNlbGVjdG9yOiBzZWxlY3RvcnMuY2FyZFNlbGVjdGlvbixcbn0pO1xuXG5hcGlcbiAgLmdldEluaXRpYWxDYXJkcygpXG4gIC50aGVuKChyZXMpID0+IHtcbiAgICAvLyBjb25zb2xlLmxvZyhyZXMpXG4gICAgY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMocmVzKTtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IGFsZXJ0KGVycikpO1xuXG5cbiAgXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIEltYWdlIE1vZGFsXG5jb25zdCBpbWFnZU1vZGFsID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI2ltYWdlLXByZXZpZXctbW9kYWxcIik7XG5pbWFnZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmZ1bmN0aW9uIG9wZW5QcmV2aWV3TW9kYWwoY2FyZERhdGEpIHtcbiAgaW1hZ2VNb2RhbC5vcGVuKGNhcmREYXRhKTtcbn1cblxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBBZGQgQ2FyZCBNb2RhbFxuXG4vL2NhcmRBZGRNb2RhbCB2YWxpZGF0aW9uXG5jb25zdCBjYXJkQWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgY2FyZEFkZEZvcm0pO1xuY2FyZEFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG4vLyBGdW5jdGlvbiB0byBoYW5kbGUgZm9ybSBzdWJtaXNzaW9uIGFuZCBhZGQgYSBuZXcgY2FyZFxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZFN1Ym1pdCh7IHRpdGxlLCB1cmwgfSkge1xuICBuZXdDYXJkTW9kYWwuaGFuZGxlTG9hZCh0cnVlLCBcIlNhdmluZy4uLlwiKTtcbiAgY29uc3QgbmV3Q2FyZERhdGEgPSB7IG5hbWU6IHRpdGxlLCBsaW5rOiB1cmwgfTtcblxuICAvLyBBZGQgbmV3IGNhcmQgdGhyb3VnaCBBUElcbiAgYXBpXG4gICAgLnVwbG9hZENhcmQobmV3Q2FyZERhdGEpXG4gICAgLnRoZW4oKGNhcmQpID0+IHtcbiAgICAgIGNvbnN0IG5ld0NhcmQgPSBjcmVhdGVDYXJkKGNhcmQpO1xuICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShuZXdDYXJkKTsgLy8gQWRkIHRoZSBuZXcgY2FyZCB0byB0aGUgc2VjdGlvblxuICAgICAgbmV3Q2FyZE1vZGFsLmNsb3NlKCk7IC8vIENsb3NlIHRoZSBtb2RhbCBhZnRlciBhZGRpbmcgdGhlIGNhcmRcbiAgICAgIGNhcmRBZGRGb3JtVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKTsgLy8gRGlzYWJsZSB0aGUgZm9ybSBzdWJtaXNzaW9uIGJ1dHRvblxuICAgICAgY2FyZEFkZEZvcm0ucmVzZXQoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBhZGRpbmcgY2FyZDpcIiwgZXJyb3IpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgbmV3Q2FyZE1vZGFsLmhhbmRsZUxvYWQoZmFsc2UpOyAvLyBSZXNldCB0aGUgYnV0dG9uIHRleHRcbiAgICB9KTtcbn1cblxuLy8gSW5zdGFuY2Ugb2YgUG9wdXBXaXRoRm9ybSBmb3IgYWRkaW5nIGEgbmV3IGNhcmRcbmNvbnN0IG5ld0NhcmRNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI2NhcmQtYWRkLW1vZGFsXCIsIGhhbmRsZUFkZENhcmRTdWJtaXQpO1xubmV3Q2FyZE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5hZGRDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIG5ld0NhcmRNb2RhbC5vcGVuKCk7XG59KTtcblxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBQcm9maWxlIGVkaXQgTW9kYWxcblxuLy9Qcm9maWxlIE1vZGFsIHZhbGlkYXRpb25cbmNvbnN0IGVkaXRQcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICB2YWxpZGF0aW9uU2V0dGluZ3MsXG4gIHByb2ZpbGVFZGl0Rm9ybVxuKTtcbmVkaXRQcm9maWxlRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbi8vIEZ1bmN0aW9uIHRvIGhhbmRsZSBmb3JtIHN1Ym1pc3Npb24gYW5kIHVwZGF0ZSB0aGUgcHJvZmlsZVxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQoaW5wdXQpIHtcbiAgcHJvZmlsZU1vZGFsLmhhbmRsZUxvYWQodHJ1ZSwgXCJTYXZpbmcuLi5cIik7XG5cbiAgYXBpXG4gICAgLnNldFVzZXJJbmZvKGlucHV0KVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGlucHV0KTtcbiAgICAgIHByb2ZpbGVNb2RhbC5jbG9zZSgpO1xuICAgICAgcHJvZmlsZUVkaXRGb3JtLnJlc2V0KCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgdXBkYXRpbmcgcHJvZmlsZTpcIiwgZXJyb3IpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgcHJvZmlsZU1vZGFsLmhhbmRsZUxvYWQoZmFsc2UpOyAvLyBSZXNldCB0aGUgYnV0dG9uIHRleHRcbiAgICB9KTtcbn1cblxuLy8gY3JlYXRlIGFuIGluc3RhbmNlIG9mIFBvcHVwV2l0aEZvcm0gZm9yIHRoZSBwcm9maWxlIG1vZGFsXG5jb25zdCBwcm9maWxlTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIsXG4gIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0XG4pO1xucHJvZmlsZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIG9wZW4gdGhlIHByb2ZpbGUgbW9kYWwgb24gYnV0dG9uIGNsaWNrXG5jb25zdCBvcGVuUHJvZmlsZU1vZGFsQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcbm9wZW5Qcm9maWxlTW9kYWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY29uc3QgaW5wdXQgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICBwcm9maWxlTW9kYWwuc2V0SW5wdXRWYWx1ZXMoaW5wdXQpO1xuICBlZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIHByb2ZpbGVNb2RhbC5vcGVuKCk7XG59KTtcblxuLy8gQ2FyZCBkZWxldGUgY29uZmlybSBNb2RhbCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbmNvbnN0IGNvbmZpcm1Qb3B1cCA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24oXCIjbW9kYWwtY29uZmlybVwiLCAoKSA9PiB7fSk7XG5jb25maXJtUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gQXZhdGFyIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5jb25zdCBwcm9maWxlSW1hZ2VGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LWF2YXRhci1mb3JtXCIpO1xuY29uc3QgZWRpdEF2YXRlckZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgdmFsaWRhdGlvblNldHRpbmdzLFxuICBwcm9maWxlSW1hZ2VGb3JtXG4pO1xuZWRpdEF2YXRlckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCBuZXdQcm9maWxlSW1hZ2VNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNlZGl0LWF2YXRhci1tb2RhbFwiLFxuICBoYW5kbGVQcm9maWxlSW1hZ2VGb3JtU3VibWl0XG4pO1xubmV3UHJvZmlsZUltYWdlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUltYWdlRm9ybVN1Ym1pdChkYXRhKSB7XG4gIG5ld1Byb2ZpbGVJbWFnZU1vZGFsLmhhbmRsZUxvYWQodHJ1ZSwgXCJTYXZpbmcuLi5cIik7XG4gIGFwaVxuICAgIC5zZXRVc2VyQXZhdGFyKGRhdGEuYXZhdGFyKVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldEF2YXRhckltYWdlKGRhdGEuYXZhdGFyKTtcbiAgICAgIG5ld1Byb2ZpbGVJbWFnZU1vZGFsLmNsb3NlKCk7XG4gICAgICBwcm9maWxlSW1hZ2VGb3JtLnJlc2V0KCk7XG4gICAgICAvLyBwcm9maWxlSW1hZ2VGb3JtLmNsb3NlKCk7XG4gICAgICBlZGl0QXZhdGVyRm9ybVZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKCk7XG4gICAgICBwcm9maWxlSW1hZ2VGb3JtLnJlc2V0KCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgbmV3UHJvZmlsZUltYWdlTW9kYWwuaGFuZGxlTG9hZChmYWxzZSk7XG4gICAgfSk7XG59XG5cbmNvbnN0IHByb2ZpbGVJbWFnZUNvdmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWltYWdlXCIpO1xucHJvZmlsZUltYWdlQ292ZXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgbmV3UHJvZmlsZUltYWdlTW9kYWwub3BlbigpO1xufSk7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xuICB9XG5cbiAgX3JlcXVlc3QoZW5kcG9pbnQsIHsgbWV0aG9kLCBib2R5IH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0ke2VuZHBvaW50fWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBtZXRob2Q6IG1ldGhvZCxcbiAgICAgIGJvZHk6IGJvZHksXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9jaGVja1Jlc3BvbnNlKHJlcykpO1xuICB9XG5cbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XG4gICAgcmV0dXJuIHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgL2NhcmRzYCwge30pO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYC91c2Vycy9tZWAsIHt9KTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKHsgbW9kYWxUaXRsZSwgZGVzY3JpcHRpb24gfSkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAvdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZTogbW9kYWxUaXRsZSwgYWJvdXQ6IGRlc2NyaXB0aW9uIH0pLFxuICAgIH0pO1xuICB9XG5cbiAgc2V0VXNlckF2YXRhcihsaW5rKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYC91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyOiBsaW5rIH0pLFxuICAgIH0pO1xuICB9XG5cbiAgdXBsb2FkQ2FyZCh7IG5hbWUsIGxpbmsgfSkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAvY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBsaW5rOiBsaW5rLFxuICAgICAgfSksXG4gICAgfSk7XG4gIH1cblxuICBkZWxldGVDYXJkKGlkKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYC9jYXJkcy8ke2lkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICB9KTtcbiAgfVxuXG4gIHVwZGF0ZUNhcmRMaWtlKGlkLCBtZXRob2QpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgL2NhcmRzLyR7aWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBtZXRob2QsXG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyB1c2VyTmFtZSwgdXNlckpvYiAsIGF2YXRhclNlbGVjdG9yfSkge1xuICAgIHRoaXMudXNlck5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJOYW1lKTtcbiAgICB0aGlzLnVzZXJKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJKb2IpO1xuICAgIHRoaXMuYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICB0aGlzLl91c2VySW5mbyA9IHtcbiAgICAgIG1vZGFsVGl0bGU6IHRoaXMudXNlck5hbWUudGV4dENvbnRlbnQsXG4gICAgICBkZXNjcmlwdGlvbjogdGhpcy51c2VySm9iLnRleHRDb250ZW50LFxuICAgIH07XG4gICAgcmV0dXJuIHRoaXMuX3VzZXJJbmZvO1xuICB9XG5cbiAgc2V0VXNlckluZm8oeyBtb2RhbFRpdGxlLCBkZXNjcmlwdGlvbiB9KSB7XG4gICAgdGhpcy51c2VyTmFtZS50ZXh0Q29udGVudCA9IG1vZGFsVGl0bGU7XG4gICAgdGhpcy51c2VySm9iLnRleHRDb250ZW50ID0gZGVzY3JpcHRpb247XG4gIH1cblxuICBzZXRBdmF0YXJJbWFnZShsaW5rKXtcbiAgICB0aGlzLmF2YXRhci5zcmMgPSBsaW5rO1xuICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHtyZW5kZXJlciwgc2VsZWN0b3J9KSB7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9lbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gIH1cblxuICByZW5kZXJJdGVtcyhpdGVtcykge1xuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHRoaXMuX3JlbmRlcmVyKGl0ZW0pKTtcbiAgfVxuXG4gIGFkZEl0ZW0oaXRlbSl7XG4gICAgdGhpcy5fZWxlbWVudC5wcmVwZW5kKGl0ZW0pO1xuICB9XG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIoe3BvcHVwU2VsZWN0b3J9KTtcblxuICAgIHRoaXMuX2ltYWdlRWwgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG4gICAgdGhpcy5fdGl0bGVFbCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xuICB9XG5cbiAgb3BlbihjYXJkRGF0YSkge1xuICAgIHRoaXMuX2ltYWdlRWwuc3JjID0gY2FyZERhdGEubGluaztcbiAgICB0aGlzLl9pbWFnZUVsLmFsdCA9IGNhcmREYXRhLm5hbWU7XG4gICAgdGhpcy5fdGl0bGVFbC50ZXh0Q29udGVudCA9IGNhcmREYXRhLm5hbWU7XG5cbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvciwgb25Db25maXJtKSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gICAgdGhpcy5fb25Db25maXJtID0gb25Db25maXJtO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XG4gIH1cblxuICBzZXRTdWJtaXQoYWN0aW9uKSB7XG4gICAgdGhpcy5faGFuZGxlU3VibWl0Q2FsbGJhY2sgPSBhY3Rpb247XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVTdWJtaXRDYWxsYmFjaygpO1xuICAgIH0pO1xuICB9XG59XG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVDbGljayIsImhhbmRsZUxpa2VDbGljayIsInRoaXMiLCJpc0xpa2VkIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2lkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZUxpa2VDbGljayIsIl9nZXRUZW1wbGF0ZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfaGFuZGxlTGlrZUJ1dHRvbiIsIl9saWtlQnV0dG9uIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiX2hhbmRsZURlbGV0ZUNhcmQiLCJfY2FyZEVsZW1lbnQiLCJyZW1vdmUiLCJyZW5kZXJMaWtlSWNvbiIsImFkZCIsInNldElzTGlrZWQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJhZGRFdmVudExpc3RlbmVyIiwiZ2V0VmlldyIsImNhcmRJbWFnZSIsInNyYyIsImFsdCIsInRleHRDb250ZW50Iiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtRWxlbWVudCIsIl9pbnB1dExpc3QiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3N1Ym1pdEJ1dHRvbiIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWwiLCJlcnJvck1lc3NhZ2VFbGVtZW50IiwiaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hhc0ludmFsaWRJbnB1dCIsInNvbWUiLCJpbnB1dEVsZW1lbnQiLCJkaXNhYmxlQnV0dG9uIiwiZGlzYWJsZWQiLCJfZW5hYmxlQnV0dG9uIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZm9yRWFjaCIsInJlc2V0VmFsaWRhdGlvbiIsImVuYWJsZVZhbGlkYXRpb24iLCJlIiwicHJldmVudERlZmF1bHQiLCJjYXJkQWRkRm9ybSIsImZvcm1zIiwicHJvZmlsZUVkaXRGb3JtIiwidmFsaWRhdGlvblNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiUG9wdXAiLCJfcmVmIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJfY2xvc2VCdXR0b24iLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwib3BlbiIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2dCIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY3VycmVudFRhcmdldCIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfc3VibWl0QnV0dG9uVGV4dCIsIl9nZXRJbnB1dFZhbHVlcyIsIl9mb3JtVmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInNldElucHV0VmFsdWVzIiwicmVzZXRCdXR0b25UZXh0IiwiY2xvc2VBZnRlclN1Ym1pdCIsInJlc2V0IiwiaGFuZGxlTG9hZCIsImlzTG9hZGluZyIsImxvYWRpbmdUZXh0IiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX3JlcXVlc3QiLCJlbmRwb2ludCIsIl9yZWYyIiwibWV0aG9kIiwiYm9keSIsImZldGNoIiwidGhlbiIsInJlcyIsIl9jaGVja1Jlc3BvbnNlIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldEluaXRpYWxDYXJkcyIsImdldFVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJfcmVmMyIsIm1vZGFsVGl0bGUiLCJkZXNjcmlwdGlvbiIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsInNldFVzZXJBdmF0YXIiLCJhdmF0YXIiLCJ1cGxvYWRDYXJkIiwiX3JlZjQiLCJkZWxldGVDYXJkIiwidXBkYXRlQ2FyZExpa2UiLCJhdXRob3JpemF0aW9uIiwidXNlckluZm8iLCJ1c2VyTmFtZSIsInVzZXJKb2IiLCJhdmF0YXJTZWxlY3RvciIsIl91c2VySW5mbyIsInNldEF2YXRhckltYWdlIiwiY3JlYXRlQ2FyZCIsIm9wZW5QcmV2aWV3TW9kYWwiLCJoYW5kbGVDYXJkRGVsZXRlIiwiaGFuZGxlQ2FyZExpa2UiLCJjYXJkIiwiY29uZmlybVBvcHVwIiwic2V0U3VibWl0IiwiY2F0Y2giLCJlcnIiLCJhbGVydCIsImNhcmRTZWN0aW9uIiwicmVuZGVyZXIiLCJzZWxlY3RvciIsIl9yZW5kZXJlciIsIl9lbGVtZW50IiwicmVuZGVySXRlbXMiLCJpdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwicHJlcGVuZCIsImNhcmRFbCIsImltYWdlTW9kYWwiLCJfaW1hZ2VFbCIsIl90aXRsZUVsIiwiY2FyZERhdGEiLCJjYXJkQWRkRm9ybVZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiLCJuZXdDYXJkTW9kYWwiLCJ0aXRsZSIsInVybCIsIm5ld0NhcmREYXRhIiwibmV3Q2FyZCIsImVycm9yIiwiY29uc29sZSIsImZpbmFsbHkiLCJlZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IiLCJwcm9maWxlTW9kYWwiLCJvbkNvbmZpcm0iLCJfb25Db25maXJtIiwiYWN0aW9uIiwiX2hhbmRsZVN1Ym1pdENhbGxiYWNrIiwicHJvZmlsZUltYWdlRm9ybSIsImVkaXRBdmF0ZXJGb3JtVmFsaWRhdG9yIiwibmV3UHJvZmlsZUltYWdlTW9kYWwiXSwic291cmNlUm9vdCI6IiJ9