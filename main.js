!function(){"use strict";class t{constructor(t,e,s){this._name=t.name,this._link=t.link,this._cardSelector=e,this._handleImageClick=s}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_handleLikeButton(){this._likeButton.classList.toggle("card__like_button_active")}_handleDeleteCard(){this._cardElement.remove()}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeButton()})),this._cardElement.querySelector(".card__delete_button").addEventListener("click",(()=>{this._handleDeleteCard()})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}getView(){this._cardElement=this._getTemplate(),this._likeButton=this._cardElement.querySelector(".card__like_button");const t=this._cardElement.querySelector(".card__image");return t.src=this._link,t.alt=this._name,this._cardElement.querySelector(".card__title").textContent=this._name,this._setEventListeners(),this._cardElement}}var e=class{constructor(t,e){this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._formElement=e,this._inputList=[...this._formElement.querySelectorAll(this._inputSelector)],this._submitButton=this._formElement.querySelector(this._submitButtonSelector)}_showInputError(t){const e=this._formElement.querySelector(`#${t.id}-error`);t.classList.add(this._inputErrorClass),e.textContent=t.validationMessage,e.classList.add(this._errorClass)}_hideInputError(t){const e=this._formElement.querySelector(`#${t.id}-error`);t.classList.remove(this._inputErrorClass),e.textContent="",e.classList.remove(this._errorClass)}_checkInputValidity(t){t.validity.valid?this._hideInputError(t):this._showInputError(t)}_hasInvalidInput(){return this._inputList.some((t=>!t.validity.valid))}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_toggleButtonState(){this._hasInvalidInput()?this.disableButton():this._enableButton()}_setEventListeners(){this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this._toggleButtonState()}))}))}resetValidation(){this._toggleButtonState(),this._inputList.forEach((t=>{this._hideInputError(t)}))}enableValidation(){this._formElement.addEventListener("submit",(t=>{t.preventDefault(),this._toggleButtonState()})),this._setEventListeners(),this._toggleButtonState()}};const s=document.forms["card-add-form"],n=document.forms["profile-edit-form"],i=(document.querySelector(".cards__list"),{formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"});class o{constructor(t){let{popupSelector:e}=t;this._popupElement=document.querySelector(e),this._closeButton=this._popupElement.querySelector(".modal__close"),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.toggle("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(t){"Escape"===t.key&&this.close()}setEventListeners(){this._closeButton.addEventListener("click",(()=>{this.close()})),this._popupElement.addEventListener("click",(t=>{t.target===t.currentTarget&&this.close()}))}}class r extends o{constructor(t,e){super({popupSelector:t}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._inputList=[...this._popupForm.querySelectorAll(".modal__input")],this._handleFormSubmit=e}_getInputValues(){return this._formValues={},this._inputList.forEach((t=>{this._formValues[t.name]=t.value})),this._formValues}setInputValues(t){this._inputList.forEach((e=>{e.value=t[e.name]}))}setEventListeners(){this._popupForm.addEventListener("submit",(t=>{t.preventDefault(),this._handleFormSubmit(this._getInputValues()),this._popupForm.reset()})),super.setEventListeners()}}function a(e){return new t(e,"#card-template",u).getView()}const l=new class{constructor(t){let{renderer:e,selector:s}=t;this._renderer=e,this._element=document.querySelector(s)}renderItems(t){t.forEach((t=>this._renderer(t)))}addItem(t){this._element.prepend(t)}}({renderer:t=>{const e=a(t);l.addItem(e)},selector:".cards__list"});l.renderItems([{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}]);const c=new class extends o{constructor(t){super({popupSelector:t}),this._imageEl=this._popupElement.querySelector(".modal__image"),this._titleEl=this._popupElement.querySelector(".modal__caption")}open(t){this._imageEl.src=t.link,this._imageEl.alt=t.name,this._titleEl.textContent=t.name,super.open()}}("#image-preview-modal");function u(t){c.open(t)}c.setEventListeners();const _=new e(i,s);_.enableValidation();const d=new r("#card-add-modal",(function(t){let{title:e,url:s}=t;const n=a({name:e,link:s});l.addItem(n),d.close(),_.disableButton()}));d.setEventListeners(),document.querySelector(".profile__add-button").addEventListener("click",(()=>{d.open()}));const m=new e(i,n);m.enableValidation();const h=new r("#profile-edit-modal",(function(t){p.setUserInfo(t),h.close()}));h.setEventListeners(),document.querySelector(".profile__edit-button").addEventListener("click",(()=>{const t=p.getUserInfo();h.setInputValues(t),m.resetValidation(),h.open()}));const p=new class{constructor(t){let{userName:e,userJob:s}=t;this.userName=document.querySelector(e),this.userJob=document.querySelector(s)}getUserInfo(){return this._userInfo={modalTitle:this.userName.textContent,description:this.userJob.textContent},this._userInfo}setUserInfo(t){let{modalTitle:e,description:s}=t;this.userName.textContent=e,this.userJob.textContent=s}}({userName:".profile__title",userJob:".profile__description"})}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WUFBRUMsR0FBYUMsRUFDckNoSSxLQUFLMkgsU0FBU2xHLFlBQWNxRyxFQUM1QjlILEtBQUs0SCxRQUFRbkcsWUFBY3NHLENBQzdCLEdIb0Y0QixDQUFFSixTQUhaLGtCQUdtQ0MsUUFGNUIseUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihkYXRhLCBjYXJkU2VsZWN0b3IsIGhhbmRsZUltYWdlQ2xpY2spIHtcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuXG4gIH1cblxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgY29uc3QgY2FyZEVsID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcikuY29udGVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkJykuY2xvbmVOb2RlKHRydWUpO1xuICAgIHJldHVybiBjYXJkRWw7XG4gIH1cblxuICBfaGFuZGxlTGlrZUJ1dHRvbigpIHtcbiAgICAvLyB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2VfYnV0dG9uXCIpXG4gICAgLy8gICAuY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2VfYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2VfYnV0dG9uX2FjdGl2ZVwiKTtcbiAgfVxuXG4gIF9oYW5kbGVEZWxldGVDYXJkKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIC8vIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZV9idXR0b25cIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAvLyAgIHRoaXMuX2hhbmRsZUxpa2VCdXR0b24oKTtcbiAgICAvLyB9KTtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZV9idXR0b25cIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soe25hbWU6IHRoaXMuX25hbWUsIGxpbms6IHRoaXMuX2xpbmt9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGdldFZpZXcoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2VfYnV0dG9uXCIpO1xuICAgIGNvbnN0IGNhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gICAgY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgY2FyZEltYWdlLmFsdCA9IHRoaXMuX25hbWU7XG5cbiAgICBjb25zdCBjYXJkVGl0bGUgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xuICAgIGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG5cbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcbiAgfVxuXG59IiwiY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xuXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbLi4udGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKV07XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbCkge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCkge1xuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xuICAgIH1cbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+ICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xuICB9XG5cbiAgZGlzYWJsZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICB9XG5cbiAgX2VuYWJsZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgfVxuXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9lbmFibGVCdXR0b24oKTtcbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0pO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTsgIC8vIENhbGwgdG8gY2hlY2sgdGhlIGJ1dHRvbiBzdGF0ZSBvbiBzdWJtaXRcbiAgICB9KTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcbiIsIlxuXG5leHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcbiAgfSxcbl07XG5cbmV4cG9ydCBjb25zdCBjYXJkQWRkRm9ybSA9IGRvY3VtZW50LmZvcm1zWydjYXJkLWFkZC1mb3JtJ107XG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gZG9jdW1lbnQuZm9ybXNbJ3Byb2ZpbGUtZWRpdC1mb3JtJ107XG5leHBvcnQgY29uc3QgY2FyZExpc3RFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkc19fbGlzdCcpO1xuXG5cblxuZXhwb3J0IGNvbnN0IHNlbGVjdG9ycyA9IHtcbiAgY2FyZFRlbXBsYXRlOiAnI2NhcmQtdGVtcGxhdGUnLFxuICBjYXJkU2VsZWN0aW9uOiAnLmNhcmRzX19saXN0JyxcbiAgLy8gYW55IG90aGVyIHNlbGVjdG9ycyB5b3UgbWlnaHQgbmVlZFxufTtcblxuLy8gRm9ybVZhbGlkYXRpb25cbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uU2V0dGluZ3MgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXG59OyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yfSkge1xuXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdtb2RhbF9vcGVuZWQnKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnRvZ2dsZSgnbW9kYWxfb3BlbmVkJyk7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICAgIC8vIGxpc3RlbnMgZm9yIGVzYyBidXR0b25cbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIC8vIHNldHMgZXZlbnQgbGlzdGVuZXJzXG4gICAgdGhpcy5fY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xuICAgICAgaWYgKGV2dC50YXJnZXQgPT09IGV2dC5jdXJyZW50VGFyZ2V0KSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICAgIHN1cGVyKHtwb3B1cFNlbGVjdG9yfSk7XG4gICAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19mb3JtJyk7XG4gICAgICB0aGlzLl9pbnB1dExpc3QgPSBbLi4udGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJy5tb2RhbF9faW5wdXQnKV07XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICAvLyB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybV9faW5wdXRcIik7XG4gICAgICB0aGlzLl9mb3JtVmFsdWVzID0ge307XG4gICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgICAgICB0aGlzLl9mb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiB0aGlzLl9mb3JtVmFsdWVzO1xuICB9XG5cbiAgc2V0SW5wdXRWYWx1ZXMoZGF0YSkge1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xuICAgIH0pO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2dCkgPT4ge1xuICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgICAgICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XG4gICAgICB9KTtcbiAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxufSIsImltcG9ydCAnLi9pbmRleC5jc3MnO1xuXG4vLyBpbXBvcnQgYWxsIHRoZSBjbGFzc2VzXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQge2luaXRpYWxDYXJkcywgc2VsZWN0b3JzLCB2YWxpZGF0aW9uU2V0dGluZ3MsIGNhcmRBZGRGb3JtLCBwcm9maWxlRWRpdEZvcm19XG4gICAgICBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tICcuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzJztcblxuXG5cbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoZGF0YSkge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoZGF0YSwgJyNjYXJkLXRlbXBsYXRlJywgb3BlblByZXZpZXdNb2RhbCk7XG4gIHJldHVybiBjYXJkLmdldFZpZXcoKTtcbn1cblxuY29uc3QgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbih7XG4gIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xuICAgIGNvbnN0IGNhcmRFbCA9IGNyZWF0ZUNhcmQoaXRlbSk7XG4gICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRWwpO1xuICB9LFxuICBzZWxlY3Rvcjogc2VsZWN0b3JzLmNhcmRTZWxlY3Rpb24sXG59KTtcbmNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKGluaXRpYWxDYXJkcyk7XG5cblxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBJbWFnZSBNb2RhbFxuY29uc3QgaW1hZ2VNb2RhbCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNpbWFnZS1wcmV2aWV3LW1vZGFsXCIpO1xuaW1hZ2VNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBvcGVuUHJldmlld01vZGFsKGNhcmREYXRhKSB7XG4gIGltYWdlTW9kYWwub3BlbihjYXJkRGF0YSk7XG59XG5cblxuXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIEFkZCBDYXJkIE1vZGFsXG5cbi8vY2FyZEFkZE1vZGFsIHZhbGlkYXRpb25cbmNvbnN0IGNhcmRBZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBjYXJkQWRkRm9ybSk7XG5jYXJkQWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbi8vIEZ1bmN0aW9uIHRvIGhhbmRsZSBmb3JtIHN1Ym1pc3Npb24gYW5kIGFkZCBhIG5ldyBjYXJkXG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkU3VibWl0KHsgdGl0bGUsIHVybCB9KSB7XG4gIC8vIGNvbnN0IHsgdGl0bGUsIHVybCB9ID0gZm9ybVZhbHVlcztcbiAgY29uc3QgbmV3Q2FyZERhdGEgPSB7IG5hbWU6IHRpdGxlLCBsaW5rOiB1cmwgfTtcbiAgY29uc3QgbmV3Q2FyZCA9IGNyZWF0ZUNhcmQobmV3Q2FyZERhdGEpO1xuICBjYXJkU2VjdGlvbi5hZGRJdGVtKG5ld0NhcmQpO1xuXG4gIG5ld0NhcmRNb2RhbC5jbG9zZSgpO1xuICBjYXJkQWRkRm9ybVZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKCk7XG59XG5cbi8vIEluc3RhbmNlIG9mIFBvcHVwV2l0aEZvcm0gZm9yIGFkZGluZyBhIG5ldyBjYXJkXG5jb25zdCBuZXdDYXJkTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNjYXJkLWFkZC1tb2RhbFwiLCBoYW5kbGVBZGRDYXJkU3VibWl0KTtcbm5ld0NhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZC1idXR0b24nKTtcbmFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgbmV3Q2FyZE1vZGFsLm9wZW4oKTtcbn0pO1xuXG5cblxuXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIFByb2ZpbGUgZWRpdCBNb2RhbFxuXG4vL1Byb2ZpbGUgTW9kYWwgdmFsaWRhdGlvblxuY29uc3QgZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBwcm9maWxlRWRpdEZvcm0pO1xuZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuLy8gRnVuY3Rpb24gdG8gaGFuZGxlIGZvcm0gc3VibWlzc2lvbiBhbmQgdXBkYXRlIHRoZSBwcm9maWxlXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdChpbnB1dCkge1xuICB1c2VySW5mby5zZXRVc2VySW5mbyhpbnB1dCk7XG4gIHByb2ZpbGVNb2RhbC5jbG9zZSgpO1xufVxuXG4vLyBjcmVhdGUgYW4gaW5zdGFuY2Ugb2YgUG9wdXBXaXRoRm9ybSBmb3IgdGhlIHByb2ZpbGUgbW9kYWxcbmNvbnN0IHByb2ZpbGVNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKCBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIiAsIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KTtcbnByb2ZpbGVNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBvcGVuIHRoZSBwcm9maWxlIG1vZGFsIG9uIGJ1dHRvbiBjbGlja1xuY29uc3Qgb3BlblByb2ZpbGVNb2RhbEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWJ1dHRvbicpO1xub3BlblByb2ZpbGVNb2RhbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjb25zdCBpbnB1dCA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIHByb2ZpbGVNb2RhbC5zZXRJbnB1dFZhbHVlcyhpbnB1dCk7XG4gIGVkaXRQcm9maWxlRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbiAgcHJvZmlsZU1vZGFsLm9wZW4oKTtcbn0pO1xuXG5cbi8vdXNlckluZm9cbmNvbnN0IHByb2ZpbGVOYW1lID0gXCIucHJvZmlsZV9fdGl0bGVcIjtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCI7XG4vLyBDcmVhdGUgdXNlciBpbmZvIGluc3RhbmNlXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7IHVzZXJOYW1lOiBwcm9maWxlTmFtZSwgdXNlckpvYjogcHJvZmlsZURlc2NyaXB0aW9ufSk7XG5cblxuXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHtyZW5kZXJlciwgc2VsZWN0b3J9KSB7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9lbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gIH1cblxuICByZW5kZXJJdGVtcyhpdGVtcykge1xuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHRoaXMuX3JlbmRlcmVyKGl0ZW0pKTtcbiAgfVxuXG4gIGFkZEl0ZW0oaXRlbSl7XG4gICAgdGhpcy5fZWxlbWVudC5wcmVwZW5kKGl0ZW0pO1xuICB9XG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIoe3BvcHVwU2VsZWN0b3J9KTtcblxuICAgIHRoaXMuX2ltYWdlRWwgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG4gICAgdGhpcy5fdGl0bGVFbCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xuICB9XG5cbiAgb3BlbihjYXJkRGF0YSkge1xuICAgIHRoaXMuX2ltYWdlRWwuc3JjID0gY2FyZERhdGEubGluaztcbiAgICB0aGlzLl9pbWFnZUVsLmFsdCA9IGNhcmREYXRhLm5hbWU7XG4gICAgdGhpcy5fdGl0bGVFbC50ZXh0Q29udGVudCA9IGNhcmREYXRhLm5hbWU7XG5cbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHsgdXNlck5hbWUsIHVzZXJKb2IgfSkge1xuICAgIHRoaXMudXNlck5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJOYW1lKTtcbiAgICB0aGlzLnVzZXJKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJKb2IpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgdGhpcy5fdXNlckluZm8gPSB7XG4gICAgICBtb2RhbFRpdGxlOiB0aGlzLnVzZXJOYW1lLnRleHRDb250ZW50LFxuICAgICAgZGVzY3JpcHRpb246IHRoaXMudXNlckpvYi50ZXh0Q29udGVudCxcbiAgICB9O1xuICAgIHJldHVybiB0aGlzLl91c2VySW5mbztcbiAgfVxuXG4gIHNldFVzZXJJbmZvKHsgbW9kYWxUaXRsZSwgZGVzY3JpcHRpb24gfSkge1xuICAgIHRoaXMudXNlck5hbWUudGV4dENvbnRlbnQgPSBtb2RhbFRpdGxlO1xuICAgIHRoaXMudXNlckpvYi50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xuICB9XG59Il0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwidGhpcyIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9nZXRUZW1wbGF0ZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfaGFuZGxlTGlrZUJ1dHRvbiIsIl9saWtlQnV0dG9uIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiX2hhbmRsZURlbGV0ZUNhcmQiLCJfY2FyZEVsZW1lbnQiLCJyZW1vdmUiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJhZGRFdmVudExpc3RlbmVyIiwiZ2V0VmlldyIsImNhcmRJbWFnZSIsInNyYyIsImFsdCIsInRleHRDb250ZW50Iiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtRWxlbWVudCIsIl9pbnB1dExpc3QiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3N1Ym1pdEJ1dHRvbiIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWwiLCJlcnJvck1lc3NhZ2VFbGVtZW50IiwiaWQiLCJhZGQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hhc0ludmFsaWRJbnB1dCIsInNvbWUiLCJpbnB1dEVsZW1lbnQiLCJkaXNhYmxlQnV0dG9uIiwiZGlzYWJsZWQiLCJfZW5hYmxlQnV0dG9uIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZm9yRWFjaCIsInJlc2V0VmFsaWRhdGlvbiIsImVuYWJsZVZhbGlkYXRpb24iLCJlIiwicHJldmVudERlZmF1bHQiLCJjYXJkQWRkRm9ybSIsImZvcm1zIiwicHJvZmlsZUVkaXRGb3JtIiwidmFsaWRhdGlvblNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiUG9wdXAiLCJfcmVmIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJfY2xvc2VCdXR0b24iLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwib3BlbiIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2dCIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY3VycmVudFRhcmdldCIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfZm9ybVZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJzZXRJbnB1dFZhbHVlcyIsInJlc2V0IiwiY3JlYXRlQ2FyZCIsIm9wZW5QcmV2aWV3TW9kYWwiLCJjYXJkU2VjdGlvbiIsInJlbmRlcmVyIiwic2VsZWN0b3IiLCJfcmVuZGVyZXIiLCJfZWxlbWVudCIsInJlbmRlckl0ZW1zIiwiaXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsInByZXBlbmQiLCJjYXJkRWwiLCJpbWFnZU1vZGFsIiwiX2ltYWdlRWwiLCJfdGl0bGVFbCIsImNhcmREYXRhIiwiY2FyZEFkZEZvcm1WYWxpZGF0b3IiLCJGb3JtVmFsaWRhdG9yIiwibmV3Q2FyZE1vZGFsIiwidGl0bGUiLCJ1cmwiLCJuZXdDYXJkIiwiZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yIiwicHJvZmlsZU1vZGFsIiwidXNlckluZm8iLCJzZXRVc2VySW5mbyIsImdldFVzZXJJbmZvIiwidXNlck5hbWUiLCJ1c2VySm9iIiwiX3VzZXJJbmZvIiwibW9kYWxUaXRsZSIsImRlc2NyaXB0aW9uIiwiX3JlZjIiXSwic291cmNlUm9vdCI6IiJ9